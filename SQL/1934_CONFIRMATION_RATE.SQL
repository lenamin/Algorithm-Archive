WITH CNT AS (
    SELECT S.USER_ID, COUNT(C1.USER_ID) AS TOTAL_CNT
    FROM SIGNUPS S
    LEFT JOIN CONFIRMATIONS C1 ON S.USER_ID = C1.USER_ID
    GROUP BY C1.USER_ID, S.USER_ID
)
SELECT CNT.USER_ID, ROUND(COALESCE(SUM(CASE WHEN C.ACTION = "CONFIRMED" THEN 1 ELSE 0 END) / CNT.TOTAL_CNT, 0.0), 2) AS CONFIRMATION_RATE
FROM CNT
LEFT JOIN CONFIRMATIONS C ON CNT.USER_ID = C.USER_ID
GROUP BY CNT.USER_ID